stages:
  - build
  - deploy

# --- Build Stage ---
build_app:
  image: node:18
  stage: build
  script:
    - echo "Installing dependencies..."
    - npm install
    - echo "Building React app..."
    - npm run build
  artifacts:
    paths:
      - dist   # <-- Vite output folder
  only:
    - main

# --- Deploy Stage ---
deploy_via_ftp:
  stage: deploy
  image: alpine:latest
  dependencies:
    - build_app   # <-- ensures artifacts from build_app are available
  before_script:
    - apk add --no-cache lftp
  script:
    - echo "Deploying dist folder to Devtech Innovations website..."
    - lftp -e "set ftp:ssl-allow no; mirror -R dist/ //domains/nimrodestates.com/public_html/; bye" -u "$FTP_USERNAME","$FTP_PASSWORD" $FTP_HOST
  only:
    - main




